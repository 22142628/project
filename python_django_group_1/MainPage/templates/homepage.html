{% load static %}
<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Outdoor Adventure & Hike Tracker - Australia</title>
    <link rel="stylesheet" href="{% static  'homepage.css' %}">
</head>
<body>
    <header>
        <div class="navbar">
            <div class="logo-container">
                <img src="https://media-hosting.imagekit.io/b4d5d1a98e174ca2/logo.jpg?Expires=1838444962&Key-Pair-Id=K2ZIVPTIP2VGHC&Signature=c17--Z~YwhPpaco3ieSYONB0~MEGEsuMQkcbMwkulVi2L3MmtEg~xI14BJcBDE-SjxO6zDR7pJxsq~ny66MK6xcDiHuCyxoC99eQHSSIp83gc74Egf7M5vqbtMcCuYbz6fSeDqrGw2juFAj48G-NU8TMLBsMTU2A9YALBTqoZyayhqFEIektRaxiIDpQ~TABKKwKxlxc2gpUBAB8DXRp1jjitPHSzrzwLTsqQe-Qxxhw5A2-Eq3cr5BPLcaPq74-sKXSuc~WnLE9iU9v6Cy68nRn6V38UMaRM7AkMx36Z~qidjW-KN9roo07Lc1C2eRKTD44RqbalG-~38f9d4dA7A__" alt="Outdoor Adventure Hiketracker Logo" class="logo-img">
                <a href="#" class="logo-text">
                    Outdoor Adventure & Hike Tracker
                    <span>AUSTRALIA</span>
                </a>
            </div>

        <div class="mobile-menu-btn">
            <i class="fas fa-bars"></i>
        </div>
    
        <ul class="menu">
            <li>
                <a href="#"><i class="fas fa-home"></i> Home</a>
                <ul class="dropdown">
                    <li><a href="#"><i class="fas fa-newspaper"></i> Latest Trail Updates</a></li>
                    <li><a href="#"><i class="fas fa-star"></i> Featured Adventures</a></li>
                </ul>
            </li>
            
            <li>
                <a href="#"><i class="fas fa-route"></i> Trails</a>
                <ul class="dropdown">
                    <li><a href="#" id="search-trail-btn"><i class="fas fa-search"></i> Search Trails</a></li>
                    <li><a href="{% url 'trail_submission' %}"><i class="fas fa-plus-circle"></i> Add New Trail</a></li>
                    <li><a href="trail-suggestion.html"><i class="fas fa-lightbulb"></i> Trail Suggestions</a></li>
                    <li><a href="trail-reviews.html"><i class="fas fa-comment-alt"></i> Trail Reviews</a></li>
                    <li><a href="#"><i class="fas fa-info-circle"></i> Trail Conditions</a></li>
                </ul>
            </li>
            
            <li>
                <a href="#"><i class="fas fa-users"></i> Community</a>
                <ul class="dropdown">
                    <li><a href="#"><i class="fas fa-comments"></i> Forum Discussions</a></li>
                    <li><a href="#"><i class="fas fa-trophy"></i> User Achievements & Badges</a></li>
                    <li><a href="report-form.html"><i class="fas fa-flag"></i> Report Content</a></li>
                    <li><a href="#"><i class="fas fa-handshake"></i> Meet Other Adventurers</a></li>
                </ul>
            </li>
            
            <li class="profile-item">
                <a href="#"><i class="fas fa-user"></i> Profile</a>
                <ul class="dropdown">
                    <li><a href="#"><i class="fas fa-user-circle"></i> View Profile</a></li>
                    <li><a href="#"><i class="fas fa-user-edit"></i> Edit Profile</a></li>
                    <li><a href="#"><i class="fas fa-map-marked-alt"></i> My Trails & Reviews</a></li>
                    <li><a href="#"><i class="fas fa-medal"></i> My Badges & Achievements</a></li>
                </ul>
            </li>
            
            <li class="admin-item">
                <a href="#"><i class="fas fa-lock"></i> Admin</a>
                <ul class="dropdown">
                    <li><a href="admin-trail-approval"><i class="fas fa-check-circle"></i> Approve New Trails</a></li>
                    <li><a href="admin-trail-management"><i class="fas fa-user-cog"></i> Manage Users</a></li>
                    <li><a href="admin-reported-content"><i class="fas fa-flag"></i> Review Reported Content</a></li>
                    <li><a href=""><i class="fas fa-bullhorn"></i> Send Community Updates</a></li>
                </ul>
            </li>
            
            <div class="auth-buttons">
                <a href="{% url 'user-login' %}" class="auth-button active">
                    <i class="fas fa-sign-in-alt"></i> Log In
                </a>
                <a href="{% url 'user-registration' %}" class="auth-button active">
                    <i class="fas fa-user-plus"></i> Sign Up
                </a>
            </div>
            
        </ul>
    </div>
</header>

<div class="search-modal" id="search-modal">
    <div class="search-container">
        <div class="search-header">
            <h2>Search Trails</h2>
            <button class="close-search" id="close-search">&times;</button>
        </div>
        <form class="search-form" id="main-search-form">
            <div class="search-group">
                <label for="trail-name">Trail Name</label>
                <input type="text" id="trail-name" placeholder="Enter trail name">
                <span class="error-message" id="trail-name-error"></span>
            </div>
            
            <div class="search-group">
                <label for="location">Location</label>
                <input type="text" id="location" placeholder="Enter location">
                <span class="error-message" id="location-error"></span>
            </div>
            
            <div class="search-group">
                <label for="difficulty">Difficulty Level</label>
                <select id="difficulty">
                    <option value="">Any Difficulty</option>
                    <option value="beginner">Beginner</option>
                    <option value="intermediate">Intermediate</option>
                    <option value="advanced">Advanced</option>
                </select>
                <span class="error-message" id="difficulty-error"></span>
            </div>
            
            <div class="search-group">
                <label for="distance-min">Distance Range (km)</label>
                <div class="distance-range">
                    <input type="text" id="distance-min" placeholder="Min" min="0">
                    <span>to</span>
                    <input type="text" id="distance-max" placeholder="Max" min="0">
                </div>
                <span class="error-message" id="distance-error"></span>
            </div>
            
            <div class="search-group">
                <label for="trail-type">Trail Type</label>
                <select id="trail-type">
                    <option value="">Any Type</option>
                    <option value="loop">Loop</option>
                    <option value="out-and-back">Out & Back</option>
                    <option value="point-to-point">Point-to-Point</option>
                </select>
                <span class="error-message" id="trail-type-error"></span>
            </div>
            
            <div class="search-group">
                <label>Minimum Rating</label>
                <div class="rating-input">
                    <div class="rating">
                        <input type="radio" id="star5" name="rating" value="5">
                        <label for="star5" title="5 stars">★</label>
                        <input type="radio" id="star4" name="rating" value="4">
                        <label for="star4" title="4 stars">★</label>
                        <input type="radio" id="star3" name="rating" value="3">
                        <label for="star3" title="3 stars">★</label>
                        <input type="radio" id="star2" name="rating" value="2">
                        <label for="star2" title="2 stars">★</label>
                        <input type="radio" id="star1" name="rating" value="1">
                        <label for="star1" title="1 star">★</label>
                    </div>
                </div>
            </div>
            
            <div class="search-actions">
                <button type="submit" class="search-button">Search Trails</button>
            </div>
        </form>
    </div>
</div>

<section class="hero">
    <div class="container">
        <h1>Your Path. Your Story. One Hike at a Time.</h1>
        <button id="hero-search-btn" class="cta-search-button">
            <i class="fas fa-search"></i> 
            <span>SEARCH TRAILS</span>
        </button>
        <a href="#" class="register-link">SUMMIT OF REGISTER TO SEE MAPS</a>
    </div>
</section>

<div class="container">
    <img src="https://www.exploreoutdoors.vic.gov.au/__data/assets/image/0018/518112/varieties/image_gallery_large.jpg" alt="Scenic hiking trail" class="featured-image">
</div>

<section class="trails-section">
    <div class="container">
        <h2>FEATURED TRAILS</h2>
        <div class="trail-grid" id="trail-results">
            
        </div>
    </div>
</section>

<footer>
    <div class="container">
        <p>&copy; 2023 Outdoor Adventure & Hike Tracker. All rights reserved.</p>
    </div>
</footer>

<script>
    
    const trails = [
        {
            id: 1,
            name: "Great Southern Rail Trail",
            location: "Victoria",
            difficulty: "intermediate",
            distance: 72,
            type: "out-and-back",
            rating: 4.5,
            description: "Rail trails follow the routes of former railway lines, offering scenic routes through diverse landscapes.",
            image: "https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80",
            comments: [
                {
                    author: "AdventureLover42",
                    rating: 4,
                    text: "This trail has amazing views, especially in the morning!"
                },
                {
                    author: "TrailMaster",
                    rating: 5,
                    text: "Great for beginners and families. Well maintained."
                }
            ]
        },
        {
            id: 2,
            name: "Murray to Mountains Rail Trail",
            location: "Victoria",
            difficulty: "beginner",
            distance: 116,
            type: "loop",
            rating: 4.2,
            description: "Experience the beauty of Victoria's high country on this popular trail with gentle gradients.",
            image: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80",
            comments: [
                {
                    author: "NatureExplorer",
                    rating: 5,
                    text: "The wildflowers along this trail in spring are breathtaking!"
                }
            ]
        },
        {
            id: 3,
            name: "Bass Coast Rail Trail",
            location: "Victoria",
            difficulty: "beginner",
            distance: 16,
            type: "point-to-point",
            rating: 4.0,
            description: "Follow this coastal trail for spectacular ocean views and access to beautiful beaches.",
            image: "https://images.unsplash.com/photo-1452421822248-d4c2b47f0c81?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80",
            comments: [
                {
                    author: "BeachWalker",
                    rating: 4,
                    text: "Perfect for a summer day - bring your swimsuit!"
                },
                {
                    author: "PhotographyFan",
                    rating: 5,
                    text: "Sunset views are incredible here. Don't forget your camera."
                }
            ]
        }
    ];

    
    document.addEventListener('DOMContentLoaded', function() {
        // Display trails initially
        displayTrails(trails);
        
        // Mobile menu toggle
        document.querySelector('.mobile-menu-btn').addEventListener('click', function() {
            document.querySelector('.menu').classList.toggle('active');
        });
        
        // Search modal controls
        const searchModal = document.getElementById('search-modal');
        const heroSearchBtn = document.getElementById('hero-search-btn');
        const searchBtn = document.getElementById('search-trail-btn');
        const closeSearch = document.getElementById('close-search');
        
        heroSearchBtn.addEventListener('click', function(e) {
            e.preventDefault();
            searchModal.style.display = 'flex';
        });
        
        searchBtn.addEventListener('click', function(e) {
            e.preventDefault();
            searchModal.style.display = 'flex';
        });
        
        closeSearch.addEventListener('click', function() {
            searchModal.style.display = 'none';
        });
        
        window.addEventListener('click', function(e) {
            if (e.target === searchModal) {
                searchModal.style.display = 'none';
            }
        });
        
        // Form validation
        const searchForm = document.getElementById('main-search-form');
        const trailNameInput = document.getElementById('trail-name');
        const locationInput = document.getElementById('location');
        const distanceMinInput = document.getElementById('distance-min');
        const distanceMaxInput = document.getElementById('distance-max');
        
        // Trail Name validation
        trailNameInput.addEventListener('input', function() {
            validateTrailName();
        });
        
        // Location validation
        locationInput.addEventListener('input', function() {
            validateLocation();
        });
        
        // Distance validation
        distanceMinInput.addEventListener('input', function() {
            // Force value to be non-negative
            if (this.value && Number(this.value) < 0) {
                this.value = 0;
            }
            validateDistance();
        });
        
        distanceMaxInput.addEventListener('input', function() {
            // Force value to be non-negative
            if (this.value && Number(this.value) < 0) {
                this.value = 0;
            }
            validateDistance();
        });
        
        // Form submission with validation
        searchForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate all fields
            const isTrailNameValid = validateTrailName();
            const isLocationValid = validateLocation();
            const isDistanceValid = validateDistance();
            
            // If all validations pass
            if (isTrailNameValid && isLocationValid && isDistanceValid) {
                const filters = getFilters();
                const filteredTrails = filterTrails(filters);
                displayTrails(filteredTrails);
                searchModal.style.display = 'none';
                
                // Reset error messages
                document.querySelectorAll('.error-message').forEach(el => {
                    el.textContent = '';
                });
            }
        });
        
        // Simulated login functionality
        function simulateLogin(isAdmin = false) {
            document.querySelector('.profile-item').style.display = 'block';
            if (isAdmin) {
                document.querySelector('.admin-item').style.display = 'block';
            }
        }
        
        // Initially hide profile and admin items
        document.querySelector('.profile-item').style.display = 'none';
        document.querySelector('.admin-item').style.display = 'none';
    });

    // Validation functions
    function validateTrailName() {
        const trailName = document.getElementById('trail-name').value;
        const errorElement = document.getElementById('trail-name-error');
        
        if (trailName && !/^[a-zA-Z0-9\s\-]+$/.test(trailName)) {
            errorElement.textContent = 'Trail name may only contain letters, numbers, spaces, and hyphens.';
            return false;
        } else {
            errorElement.textContent = '';
            return true;
        }
    }
    
    function validateLocation() {
        const location = document.getElementById('location').value;
        const errorElement = document.getElementById('location-error');
        
        if (location && !/^[a-zA-Z0-9\s\-]+$/.test(location)) {
            errorElement.textContent = 'Location may only contain letters, numbers, spaces, and hyphens.';
            return false;
        } else {
            errorElement.textContent = '';
            return true;
        }
    }
    
    function validateDistance() {
        const minDistance = document.getElementById('distance-min').value;
        const maxDistance = document.getElementById('distance-max').value;
        const errorElement = document.getElementById('distance-error');
        
        // Check if inputs are numbers
        const isMinValid = !minDistance || (!isNaN(Number(minDistance)) && Number(minDistance) >= 0);
        const isMaxValid = !maxDistance || (!isNaN(Number(maxDistance)) && Number(maxDistance) >= 0);
        
        // Check if min is less than max when both are provided
        const isRangeValid = !minDistance || !maxDistance ||
                             (Number(minDistance) <= Number(maxDistance));
        
        if (!isMinValid || !isMaxValid) {
            if (minDistance && isNaN(Number(minDistance)) || maxDistance && isNaN(Number(maxDistance))) {
                errorElement.textContent = 'Distance values must be numbers.';
            } else {
                errorElement.textContent = 'Distance values cannot be negative.';
            }
            return false;
        } else if (!isRangeValid) {
            errorElement.textContent = 'Minimum distance must be less than or equal to maximum distance.';
            return false;
        } else {
            errorElement.textContent = '';
            return true;
        }
    }
    
    // Get the filters from the form
    function getFilters() {
        return {
            name: document.getElementById('trail-name').value.toLowerCase(),
            location: document.getElementById('location').value.toLowerCase(),
            difficulty: document.getElementById('difficulty').value,
            minDistance: document.getElementById('distance-min').value ? Number(document.getElementById('distance-min').value) : '',
            maxDistance: document.getElementById('distance-max').value ? Number(document.getElementById('distance-max').value) : '',
            type: document.getElementById('trail-type').value,
            minRating: document.querySelector('input[name="rating"]:checked')?.value
        };
    }

    // Filter trails based on the criteria
    function filterTrails(filters) {
        return trails.filter(trail => {
            const nameMatch = !filters.name || trail.name.toLowerCase().includes(filters.name);
            const locationMatch = !filters.location || trail.location.toLowerCase().includes(filters.location);
            const difficultyMatch = !filters.difficulty || trail.difficulty === filters.difficulty;
            const minDistanceMatch = !filters.minDistance || trail.distance >= filters.minDistance;
            const maxDistanceMatch = !filters.maxDistance || trail.distance <= filters.maxDistance;
            const typeMatch = !filters.type || trail.type === filters.type;
            const ratingMatch = !filters.minRating || trail.rating >= Number(filters.minRating);
            
            return nameMatch && locationMatch && difficultyMatch && minDistanceMatch && 
                   maxDistanceMatch && typeMatch && ratingMatch;
        });
    }

    // Display filtered trails
    function displayTrails(trailsToDisplay) {
        const trailResults = document.getElementById('trail-results');
        trailResults.innerHTML = '';
        
        if (trailsToDisplay.length === 0) {
            trailResults.innerHTML = '<p class="no-results">No trails found matching your criteria.</p>';
            return;
        }
        
        trailsToDisplay.forEach(trail => {
            const trailCard = document.createElement('div');
            trailCard.className = 'trail-card';
            trailCard.innerHTML = `
                <img src="${trail.image}" alt="${trail.name}">
                <div class="trail-info">
                    <h3>${trail.name}</h3>
                    <div class="trail-meta">
                        <span><i class="fas fa-map-marker-alt"></i> ${trail.location}</span>
                        <span><i class="fas fa-tachometer-alt"></i> ${trail.difficulty}</span>
                        <span><i class="fas fa-road"></i> ${trail.distance}km</span>
                        <span><i class="fas fa-star"></i> ${trail.rating}</span>
                    </div>
                    <p>${trail.description}</p>
                    <a href="#" class="trail-link">VIEW TRAIL DETAILS →</a>
                </div>
                <div class="comments-section">
                    <h4>Comments & Ratings</h4>
                    ${trail.comments.map(comment => `
                        <div class="comment">
                            <div class="comment-author">${comment.author}</div>
                            <div class="comment-rating">
                                <span class="stars">${'★'.repeat(comment.rating)}${'☆'.repeat(5 - comment.rating)}</span>
                                <span class="rating-value">${comment.rating}.0</span>
                            </div>
                            <div class="comment-text">${comment.text}</div>
                        </div>
                    `).join('')}
                    <form class="comment-form" data-trail-id="${trail.id}">
                        <div class="rating-input">
                            <span>Your Rating: </span>
                            <div class="rating">
                                <input type="radio" id="star5-card${trail.id}" name="rating-card${trail.id}" value="5">
                                <label for="star5-card${trail.id}" title="5 stars">★</label>
                                <input type="radio" id="star4-card${trail.id}" name="rating-card${trail.id}" value="4">
                                <label for="star4-card${trail.id}" title="4 stars">★</label>
                                <input type="radio" id="star3-card${trail.id}" name="rating-card${trail.id}" value="3">
                                <label for="star3-card${trail.id}" title="3 stars">★</label>
                                <input type="radio" id="star2-card${trail.id}" name="rating-card${trail.id}" value="2">
                                <label for="star2-card${trail.id}" title="2 stars">★</label>
                                <input type="radio" id="star1-card${trail.id}" name="rating-card${trail.id}" value="1">
                                <label for="star1-card${trail.id}" title="1 star">★</label>
                            </div>
                        </div>
                        <input type="text" class="comment-input" placeholder="Add a comment...">
                        <button type="submit" class="comment-submit">Post</button>
                    </form>
                </div>
            `;
            trailResults.appendChild(trailCard);
        });
        
        // Add event listeners for comment forms
        document.querySelectorAll('.comment-form').forEach(form => {
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                const input = this.querySelector('.comment-input');
                const commentText = input.value.trim();
                const ratingInput = this.querySelector('input[name^="rating-card"]:checked');
                
                if (!ratingInput) {
                    alert('Please select a rating before submitting your comment.');
                    return;
                }
                
                if (commentText) {
                    const commentsSection = this.parentElement;
                    const newComment = document.createElement('div');
                    newComment.className = 'comment';
                    
                    const ratingValue = ratingInput.value;
                    const stars = '★'.repeat(ratingValue) + '☆'.repeat(5 - ratingValue);
                    
                    newComment.innerHTML = `
                        <div class="comment-author">You</div>
                        <div class="comment-rating">
                            <span class="stars">${stars}</span>
                            <span class="rating-value">${ratingValue}.0</span>
                        </div>
                        <div class="comment-text">${commentText}</div>
                    `;
                    
                    // Insert the new comment before the form
                    commentsSection.insertBefore(newComment, this);
                    
                    // Reset the form
                    input.value = '';
                    this.querySelectorAll('input[type="radio"]').forEach(radio => {
                        radio.checked = false;
                    });
                }
            });
        });
    }
</script>

</body>
</html>